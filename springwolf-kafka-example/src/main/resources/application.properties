import pandas as pd
import yaml
import numpy as np
import calculator  # Importa a biblioteca genérica

# Carrega o config.yml do repositório do usuário
with open("path/to/config.yml", "r") as file:
    config = yaml.safe_load(file)

# Define o tipo de cálculo e configura a função e parâmetros conforme o valor do config.yml
calculation_type = config["calculo"]
if calculation_type == "GH":
    transformation_function = pd.cut
    transformation_params = {"bins": cut_points, "labels": np.arange(1, len(cut_points))}
else:
    raise ValueError(f"Cálculo '{calculation_type}' não suportado.")

# Carrega os dados de inferência e aplica a transformação
df = pd.read_csv("path/to/inference_output.csv")
df = calculator.apply_transformation(df, "score", transformation_function, **transformation_params)

# Salva o DataFrame transformado em outro diretório no mesmo bucket
df.to_csv("path/to/transformed_output.csv", index=False)
